{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#phepy","title":"phepy","text":"<p><code>phepy</code> is a Python package to visually evaluate out-of-distribution detectors using simple toy examples.</p>"},{"location":"#installation","title":"Installation","text":""},{"location":"#pip","title":"pip","text":"<p>The <code>phepy</code> package is available on the Python Package Index (PyPI) and can be installed using <pre><code>pip install phepy\n</code></pre> This command can also be run inside a conda environment to install <code>phepy</code> with conda.</p>"},{"location":"#from-source","title":"From Source","text":"<p>First, clone the git repository using <pre><code>git clone https://github.com/juntyr/phepy.git\n</code></pre> or <pre><code>git clone git@github.com:juntyr/phepy.git\n</code></pre></p> <p>Next, enter the repository folder and use <code>pip</code> to install the program: <pre><code>cd phepy &amp;&amp; pip install .\n</code></pre></p>"},{"location":"#usage-example","title":"Usage Example","text":"<p>The following code snippet only provides a minimal example to get started, please refer to the <code>examples</code> folder to find more extensive examples.</p> <pre><code># Import numpy, matplotlib, and sklearn\nimport numpy as np\nimport sklearn\n\nfrom matplotlib import pyplot as plt\nfrom sklearn.neighbors import LocalOutlierFactor\n\n# Import phepy, three toy examples, the out-of-distribution (OOD)\n#  detector and scorer, and the plotting helper function\nimport phepy\n\nfrom phepy.detector import OutOfDistributionDetector, PercentileScorer\nfrom phepy.plot import plot_all_toy_examples\nfrom phepy.toys import ToyExample\nfrom phepy.toys.line import LineToyExample\nfrom phepy.toys.circle import CircleToyExample\nfrom phepy.toys.haystack import HaystackToyExample\n\n\n# Generate three toy test cases\nline = LineToyExample(np.random.default_rng(42))\ncircle = CircleToyExample(np.random.default_rng(42))\nhaystack = HaystackToyExample(np.random.default_rng(42))\n\n\n# Use the Local Outlier Factor (LOF) [^1] as an OOD detector\nclass LocalOutlierFactorDetector(OutOfDistributionDetector):\n    @staticmethod\n    def low_score_is_low_confidence() -&gt; bool:\n        return True\n\n    def fit(\n        self, X_train: np.ndarray, Y_train: np.ndarray\n    ):\n        self.__X_lof = LocalOutlierFactor(novelty=True).fit(X_train)\n\n        return self\n\n    def predict(self, X_test: np.ndarray) -&gt; np.ndarray:\n        return self.__X_lof.score_samples(X_test)\n\n\n# Generate the plot for the LOF detector and the three test cases\nfig = plot_all_toy_examples(\n    scorers = {\n        \"Local Outlier Factor\": PercentileScorer(LocalOutlierFactorDetector()),\n    },\n    toys = [line, circle, haystack],\n    cmap = \"coolwarm\", # use e.g. \"viridis\" to be colour-blind safe\n)\n\nplt.show()\n</code></pre> <p></p> <p>In the above figure, the single row showcases the Local Outlier Factor (LOF, <sup>1</sup>) method, while the three columns contain the following three test cases:</p> <ul> <li>Two groups of training points are scattered along a line in the 2D feature space. The target variable only depends on the location along the line. In this example, points off the line are OOD.</li> <li>The training points are scattered around the sine-displaced boundary of a circle, but none are inside it. The target variable only depends on the location along the boundary. Again, points off the line are OOD.</li> <li>The training points are sampled from a 10-dimensional multivariate normal distribution, where one of the features is set to a constant. This example tests whether an OOD detection method can find a needle in a high-dimensional haystack, i.e. identify that points which do not share the constant are OOD.</li> </ul> <p>The first two panels depict a subset of the training points using black <code>x</code> markers. Note that the first two plots do not have axis labels since the two axes map directly to the 2D feature space axes. The third plot differs and shows the distribution of confidence values on the y-axis for different x-axis values for the constant-in-training feature. The constant value is highlighted as a white line.</p> <p>The Local Outlier Factor (LOF, <sup>1</sup>) estimates the training data density around unseen data. Thus, it performs quite well on the line and circle examples where the data points are closely scattered. The LOF classifies the gap between the two groups of training inputs on the line as out-of-distribution (OOD), which may be too conservative if we assume that a machine-learning model can interpolate between the two groups. While LOF produces slightly lower confidence for the OOD inputs in the haystack, it does not clearly identify test data that do not have the constant feature seen in training as out-of-distribution.</p>"},{"location":"#license","title":"License","text":"<p>Licensed under either of</p> <ul> <li>Apache License, Version 2.0 (<code>LICENSE-APACHE</code> or http://www.apache.org/licenses/LICENSE-2.0)</li> <li>MIT license (<code>LICENSE-MIT</code> or http://opensource.org/licenses/MIT)</li> </ul> <p>at your option.</p>"},{"location":"#contribution","title":"Contribution","text":"<p>Unless you explicitly state otherwise, any contribution intentionally submitted for inclusion in the work by you, as defined in the Apache-2.0 license, shall be dual licensed as above, without any additional terms or conditions.</p>"},{"location":"#citation","title":"Citation","text":"<p>Please refer to the CITATION.cff file and refer to https://citation-file-format.github.io to extract the citation in a format of your choice.</p> <ol> <li> <p>M. M. Breunig et al. LOF: Identifying Density-Based Local Outliers. Proceedings of the 2000 ACM SIGMOD International Conference on Management of Data. SIGMOD '00. Dallas, Texas, USA: Associ- ation for Computing Machinery, 2000, 93\u2013104. Available from: doi:10.1145/342009.335388.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"api/","title":"phepy","text":""},{"location":"api/#phepy.OutOfDistributionDetector","title":"OutOfDistributionDetector","text":"<p>             Bases: <code>abc.ABC</code></p>"},{"location":"api/#phepy.OutOfDistributionDetector.fit","title":"fit  <code>abstractmethod</code>","text":"<pre><code>fit(\n    X_train: np.ndarray, Y_train: np.ndarray\n) -&gt; OutOfDistributionDetector\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef fit(\n    self, X_train: np.ndarray, Y_train: np.ndarray\n) -&gt; OutOfDistributionDetector:\n    pass\n</code></pre>"},{"location":"api/#phepy.OutOfDistributionDetector.low_score_is_low_confidence","title":"low_score_is_low_confidence  <code>abstractmethod</code> <code>staticmethod</code>","text":"<pre><code>low_score_is_low_confidence() -&gt; bool\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>@staticmethod\n@abc.abstractmethod\ndef low_score_is_low_confidence() -&gt; bool:\n    pass\n</code></pre>"},{"location":"api/#phepy.OutOfDistributionDetector.predict","title":"predict  <code>abstractmethod</code>","text":"<pre><code>predict(X_test: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef predict(self, X_test: np.ndarray) -&gt; np.ndarray:\n    pass\n</code></pre>"},{"location":"api/#phepy.OutOfDistributionScorer","title":"OutOfDistributionScorer","text":"<pre><code>OutOfDistributionScorer(\n    detector: OutOfDistributionDetector,\n)\n</code></pre> <p>             Bases: <code>abc.ABC</code></p> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef __init__(\n    self, detector: OutOfDistributionDetector\n) -&gt; OutOfDistributionScorer:\n    self.__detector = detector\n</code></pre>"},{"location":"api/#phepy.OutOfDistributionScorer.calibrate","title":"calibrate  <code>abstractmethod</code>","text":"<pre><code>calibrate(\n    X_valid: np.ndarray, Y_valid: np.ndarray\n) -&gt; OutOfDistributionScorer\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef calibrate(\n    self, X_valid: np.ndarray, Y_valid: np.ndarray\n) -&gt; OutOfDistributionScorer:\n    pass\n</code></pre>"},{"location":"api/#phepy.OutOfDistributionScorer.detector","title":"detector  <code>property</code>","text":"<pre><code>detector: OutOfDistributionDetector\n</code></pre>"},{"location":"api/#phepy.OutOfDistributionScorer.predict","title":"predict  <code>abstractmethod</code>","text":"<pre><code>predict(X_test: np.ndarray) -&gt; np.ndarray\n</code></pre> <p>Predict the confidence scores for several test data inputs.</p> PARAMETER  DESCRIPTION <code>X_test</code> <p>numpy array of shape <code>N_SAMPLES x N_FEATURES</code></p> <p> TYPE: <code>np.ndarray</code> </p> RETURNS DESCRIPTION <code>np.ndarray</code> <p>The array confidence scores of shape <code>N_SAMPLES</code></p> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef predict(self, X_test: np.ndarray) -&gt; np.ndarray:\n    \"\"\"Predict the confidence scores for several test data inputs.\n\n    Args:\n      X_test:\n        numpy array of shape `N_SAMPLES x N_FEATURES`\n\n    Returns:\n      The array confidence scores of shape `N_SAMPLES`\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/#phepy.ToyExample","title":"ToyExample","text":"<p>             Bases: <code>abc.ABC</code></p>"},{"location":"api/#phepy.ToyExample.X_test","title":"X_test  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>X_test: np.ndarray\n</code></pre>"},{"location":"api/#phepy.ToyExample.X_train","title":"X_train  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>X_train: np.ndarray\n</code></pre>"},{"location":"api/#phepy.ToyExample.X_valid","title":"X_valid  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>X_valid: np.ndarray\n</code></pre>"},{"location":"api/#phepy.ToyExample.Y_train","title":"Y_train  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>Y_train: np.ndarray\n</code></pre>"},{"location":"api/#phepy.ToyExample.Y_valid","title":"Y_valid  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>Y_valid: np.ndarray\n</code></pre>"},{"location":"api/#phepy.ToyExample.aspect_ratio","title":"aspect_ratio  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>aspect_ratio: float\n</code></pre>"},{"location":"api/#phepy.ToyExample.is_in_distribution","title":"is_in_distribution  <code>abstractmethod</code>","text":"<pre><code>is_in_distribution(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/__init__.py</code> <pre><code>@abc.abstractmethod\ndef is_in_distribution(X: np.ndarray) -&gt; np.ndarray:\n    pass\n</code></pre>"},{"location":"api/#phepy.ToyExample.plot","title":"plot  <code>abstractmethod</code>","text":"<pre><code>plot(\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n)\n</code></pre> Source code in <code>phepy/toys/__init__.py</code> <pre><code>@abc.abstractmethod\ndef plot(\n    self,\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n):\n    pass\n</code></pre>"},{"location":"api/#phepy.ToyExample.reconstruct","title":"reconstruct  <code>abstractmethod</code>","text":"<pre><code>reconstruct(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/__init__.py</code> <pre><code>@abc.abstractmethod\ndef reconstruct(X: np.ndarray) -&gt; np.ndarray:\n    pass\n</code></pre>"},{"location":"api/SUMMARY/","title":"SUMMARY","text":"<ul> <li>phepy</li> <li>phepy.detector</li> <li>phepy.plot</li> <li>phepy.toys<ul> <li>circle</li> <li>haystack</li> <li>line</li> </ul> </li> </ul>"},{"location":"api/detector/","title":"phepy.detector","text":""},{"location":"api/detector/#phepy.detector.IdentityScorer","title":"IdentityScorer","text":"<pre><code>IdentityScorer(detector: OutOfDistributionDetector)\n</code></pre> <p>             Bases: <code>OutOfDistributionScorer</code></p> Source code in <code>phepy/detector.py</code> <pre><code>def __init__(self, detector: OutOfDistributionDetector) -&gt; IdentityScorer:\n    super().__init__(detector)\n</code></pre>"},{"location":"api/detector/#phepy.detector.IdentityScorer.calibrate","title":"calibrate","text":"<pre><code>calibrate(\n    X_valid: np.ndarray, Y_valid: np.ndarray\n) -&gt; IdentityScorer\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>def calibrate(\n    self, X_valid: np.ndarray, Y_valid: np.ndarray\n) -&gt; IdentityScorer:\n    return self\n</code></pre>"},{"location":"api/detector/#phepy.detector.IdentityScorer.predict","title":"predict","text":"<pre><code>predict(X_test: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>def predict(self, X_test: np.ndarray) -&gt; np.ndarray:\n    S_test = self.detector.predict(X_test)\n\n    return (\n        S_test\n        if type(self.detector).low_score_is_low_confidence()\n        else 1.0 - S_test\n    )\n</code></pre>"},{"location":"api/detector/#phepy.detector.OutOfDistributionDetector","title":"OutOfDistributionDetector","text":"<p>             Bases: <code>abc.ABC</code></p>"},{"location":"api/detector/#phepy.detector.OutOfDistributionDetector.fit","title":"fit  <code>abstractmethod</code>","text":"<pre><code>fit(\n    X_train: np.ndarray, Y_train: np.ndarray\n) -&gt; OutOfDistributionDetector\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef fit(\n    self, X_train: np.ndarray, Y_train: np.ndarray\n) -&gt; OutOfDistributionDetector:\n    pass\n</code></pre>"},{"location":"api/detector/#phepy.detector.OutOfDistributionDetector.low_score_is_low_confidence","title":"low_score_is_low_confidence  <code>abstractmethod</code> <code>staticmethod</code>","text":"<pre><code>low_score_is_low_confidence() -&gt; bool\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>@staticmethod\n@abc.abstractmethod\ndef low_score_is_low_confidence() -&gt; bool:\n    pass\n</code></pre>"},{"location":"api/detector/#phepy.detector.OutOfDistributionDetector.predict","title":"predict  <code>abstractmethod</code>","text":"<pre><code>predict(X_test: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef predict(self, X_test: np.ndarray) -&gt; np.ndarray:\n    pass\n</code></pre>"},{"location":"api/detector/#phepy.detector.OutOfDistributionScorer","title":"OutOfDistributionScorer","text":"<pre><code>OutOfDistributionScorer(\n    detector: OutOfDistributionDetector,\n)\n</code></pre> <p>             Bases: <code>abc.ABC</code></p> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef __init__(\n    self, detector: OutOfDistributionDetector\n) -&gt; OutOfDistributionScorer:\n    self.__detector = detector\n</code></pre>"},{"location":"api/detector/#phepy.detector.OutOfDistributionScorer.calibrate","title":"calibrate  <code>abstractmethod</code>","text":"<pre><code>calibrate(\n    X_valid: np.ndarray, Y_valid: np.ndarray\n) -&gt; OutOfDistributionScorer\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef calibrate(\n    self, X_valid: np.ndarray, Y_valid: np.ndarray\n) -&gt; OutOfDistributionScorer:\n    pass\n</code></pre>"},{"location":"api/detector/#phepy.detector.OutOfDistributionScorer.detector","title":"detector  <code>property</code>","text":"<pre><code>detector: OutOfDistributionDetector\n</code></pre>"},{"location":"api/detector/#phepy.detector.OutOfDistributionScorer.predict","title":"predict  <code>abstractmethod</code>","text":"<pre><code>predict(X_test: np.ndarray) -&gt; np.ndarray\n</code></pre> <p>Predict the confidence scores for several test data inputs.</p> PARAMETER  DESCRIPTION <code>X_test</code> <p>numpy array of shape <code>N_SAMPLES x N_FEATURES</code></p> <p> TYPE: <code>np.ndarray</code> </p> RETURNS DESCRIPTION <code>np.ndarray</code> <p>The array confidence scores of shape <code>N_SAMPLES</code></p> Source code in <code>phepy/detector.py</code> <pre><code>@abc.abstractmethod\ndef predict(self, X_test: np.ndarray) -&gt; np.ndarray:\n    \"\"\"Predict the confidence scores for several test data inputs.\n\n    Args:\n      X_test:\n        numpy array of shape `N_SAMPLES x N_FEATURES`\n\n    Returns:\n      The array confidence scores of shape `N_SAMPLES`\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/detector/#phepy.detector.PercentileScorer","title":"PercentileScorer","text":"<pre><code>PercentileScorer(detector: OutOfDistributionDetector)\n</code></pre> <p>             Bases: <code>OutOfDistributionScorer</code></p> Source code in <code>phepy/detector.py</code> <pre><code>def __init__(\n    self, detector: OutOfDistributionDetector\n) -&gt; PercentileScorer:\n    super().__init__(detector)\n</code></pre>"},{"location":"api/detector/#phepy.detector.PercentileScorer.calibrate","title":"calibrate","text":"<pre><code>calibrate(\n    X_valid: np.ndarray, Y_valid: np.ndarray\n) -&gt; PercentileScorer\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>def calibrate(\n    self, X_valid: np.ndarray, Y_valid: np.ndarray\n) -&gt; PercentileScorer:\n    self.__S_valid = np.sort(self.detector.predict(X_valid))\n\n    return self\n</code></pre>"},{"location":"api/detector/#phepy.detector.PercentileScorer.predict","title":"predict","text":"<pre><code>predict(X_test: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/detector.py</code> <pre><code>def predict(self, X_test: np.ndarray) -&gt; np.ndarray:\n    S_test = np.searchsorted(\n        self.__S_valid,\n        self.detector.predict(X_test),\n    ) / len(self.__S_valid)\n\n    return (\n        S_test\n        if type(self.detector).low_score_is_low_confidence()\n        else 1.0 - S_test\n    )\n</code></pre>"},{"location":"api/plot/","title":"phepy.plot","text":""},{"location":"api/plot/#phepy.plot.ColorBar","title":"ColorBar  <code>dataclass</code>","text":""},{"location":"api/plot/#phepy.plot.ColorBar.high","title":"high  <code>instance-attribute</code>","text":"<pre><code>high: str\n</code></pre>"},{"location":"api/plot/#phepy.plot.ColorBar.low","title":"low  <code>instance-attribute</code>","text":"<pre><code>low: str\n</code></pre>"},{"location":"api/plot/#phepy.plot.ColorBar.title","title":"title  <code>instance-attribute</code>","text":"<pre><code>title: str\n</code></pre>"},{"location":"api/plot/#phepy.plot.ColorMap","title":"ColorMap  <code>module-attribute</code>","text":"<pre><code>ColorMap = Union[str, mpl.colors.Colormap]\n</code></pre>"},{"location":"api/plot/#phepy.plot.Evaluation","title":"Evaluation  <code>dataclass</code>","text":""},{"location":"api/plot/#phepy.plot.Evaluation.calibrate_time","title":"calibrate_time  <code>instance-attribute</code>","text":"<pre><code>calibrate_time: float\n</code></pre>"},{"location":"api/plot/#phepy.plot.Evaluation.confidence","title":"confidence  <code>instance-attribute</code>","text":"<pre><code>confidence: np.ndarray\n</code></pre>"},{"location":"api/plot/#phepy.plot.Evaluation.detector_size","title":"detector_size  <code>instance-attribute</code>","text":"<pre><code>detector_size: int\n</code></pre>"},{"location":"api/plot/#phepy.plot.Evaluation.expected","title":"expected  <code>instance-attribute</code>","text":"<pre><code>expected: np.ndarray\n</code></pre>"},{"location":"api/plot/#phepy.plot.Evaluation.fit_time","title":"fit_time  <code>instance-attribute</code>","text":"<pre><code>fit_time: float\n</code></pre>"},{"location":"api/plot/#phepy.plot.Evaluation.predict_time","title":"predict_time  <code>instance-attribute</code>","text":"<pre><code>predict_time: float\n</code></pre>"},{"location":"api/plot/#phepy.plot.Evaluation.scorer_size","title":"scorer_size  <code>instance-attribute</code>","text":"<pre><code>scorer_size: int\n</code></pre>"},{"location":"api/plot/#phepy.plot.ScorerCallback","title":"ScorerCallback  <code>module-attribute</code>","text":"<pre><code>ScorerCallback = Union[\n    None,\n    Callable[\n        [\n            OutOfDistributionScorer,\n            ToyExample,\n            Evaluation,\n            mpl.axes.Axes,\n        ],\n        None,\n    ],\n]\n</code></pre>"},{"location":"api/plot/#phepy.plot.plot_all_toy_examples","title":"plot_all_toy_examples","text":"<pre><code>plot_all_toy_examples(\n    scorers: Dict[str, OutOfDistributionScorer],\n    toys: List[ToyExample],\n    cmap: Union[ColorMap, List[ColorMap]],\n    with_cbar: Union[\n        None, ColorBar, List[ColorBar]\n    ] = ColorBar(\n        title=\"confidence level $c$\", low=\"0.1\", high=\"0.9\"\n    ),\n    with_titles: bool = True,\n    with_scorer: Union[\n        ScorerCallback, List[ScorerCallback]\n    ] = None,\n    with_scatter: Union[bool, List[bool]] = True,\n) -&gt; mpl.figure.Figure\n</code></pre> <p>Plot the out-of-distribution (OOD) detection performance of all given scorers across all given toy examples.</p> <p>Note that the provided scorers and their detectors will be refitted and recalibrated for each toy example.</p> PARAMETER  DESCRIPTION <code>scorers</code> <p>mapping from OOD scoring method name to an instance of the method</p> <p> TYPE: <code>Dict[str, OutOfDistributionScorer]</code> </p> <code>toys</code> <p>list of toy examples</p> <p> TYPE: <code>List[ToyExample]</code> </p> <code>cmap</code> <p>name or instance of a matplotlib Colormap that is used to encode the confidence score. A list of colormaps can be given instead to use a different one for each scorer</p> <p> TYPE: <code>Union[ColorMap, List[ColorMap]]</code> </p> <code>with_cbar</code> <p>optional colorbar specification, which is added for each row of subplots. A list of colorbars can be given instead to use a different one for each scorer</p> <p> TYPE: <code>Union[None, ColorBar, List[ColorBar]]</code> DEFAULT: <code>ColorBar(title='confidence level $c$', low='0.1', high='0.9')</code> </p> <code>with_titles</code> <p>whether each method's name should be added as a title to each row of subplots</p> <p> TYPE: <code>bool</code> DEFAULT: <code>True</code> </p> <code>with_scorer</code> <p>optional scoring function which can perform additional evaluation and plot its results. A list of functions can be given instead to use a different one for each scorer</p> <p> TYPE: <code>Union[ScorerCallback, List[ScorerCallback]]</code> DEFAULT: <code>None</code> </p> <code>with_scatter</code> <p>whether a subset of the training data should be scattered in each subplot panel. A list of booleans can be given instead to use a different one for each scorer</p> <p> TYPE: <code>Union[bool, List[bool]]</code> DEFAULT: <code>True</code> </p> RETURNS DESCRIPTION <code>mpl.figure.Figure</code> <p>The created matplotlib figure.</p> Source code in <code>phepy/plot.py</code> <pre><code>def plot_all_toy_examples(\n    scorers: Dict[str, OutOfDistributionScorer],\n    toys: List[ToyExample],\n    cmap: Union[ColorMap, List[ColorMap]],\n    with_cbar: Union[None, ColorBar, List[ColorBar]] = ColorBar(\n        title=\"confidence level $c$\",\n        low=\"0.1\",\n        high=\"0.9\",\n    ),\n    with_titles: bool = True,\n    with_scorer: Union[ScorerCallback, List[ScorerCallback]] = None,\n    with_scatter: Union[bool, List[bool]] = True,\n) -&gt; mpl.figure.Figure:\n    \"\"\"Plot the out-of-distribution (OOD) detection performance\n    of all given scorers across all given toy examples.\n\n    Note that the provided scorers and their detectors will be\n    refitted and recalibrated for each toy example.\n\n    Args:\n      scorers:\n        mapping from OOD scoring method name to an instance\n        of the method\n      toys:\n        list of toy examples\n      cmap:\n        name or instance of a matplotlib Colormap that\n        is used to encode the confidence score.\n        A list of colormaps can be given instead to use a\n        different one for each scorer\n      with_cbar:\n        optional colorbar specification, which is added for\n        each row of subplots.\n        A list of colorbars can be given instead to use a\n        different one for each scorer\n      with_titles:\n        whether each method's name should be added as a\n        title to each row of subplots\n      with_scorer:\n        optional scoring function which can perform\n        additional evaluation and plot its results.\n        A list of functions can be given instead to use a\n        different one for each scorer\n      with_scatter:\n        whether a subset of the training data should be\n        scattered in each subplot panel.\n        A list of booleans can be given instead to use a\n        different one for each scorer\n\n    Returns:\n      The created matplotlib figure.\n    \"\"\"\n    width_ratios = [toy.aspect_ratio for toy in toys]\n\n    if with_cbar:\n        width_ratios += [0.1]\n\n    fig, axs = mpl.pyplot.subplots(\n        len(scorers),\n        len(toys) + int(with_cbar is not None),\n        figsize=(4 * np.sum(width_ratios), 4 * len(scorers)),\n        gridspec_kw={\"width_ratios\": width_ratios},\n    )\n    axs = np.array(axs).reshape(\n        (len(scorers), len(toys) + int(with_cbar is not None))\n    )\n\n    if not isinstance(cmap, list):\n        cmap = [cmap for _ in scorers]\n    if not isinstance(with_cbar, list):\n        with_cbar = [with_cbar for _ in scorers]\n    if not isinstance(with_scorer, list):\n        with_scorer = [with_scorer for _ in scorers]\n    if not isinstance(with_scatter, list):\n        with_scatter = [with_scatter for _ in scorers]\n\n    for (\n        axr,\n        (title, scorer),\n        cmap,\n        with_cbar,\n        with_scorer,\n        with_scatter,\n    ) in zip(axs, scorers.items(), cmap, with_cbar, with_scorer, with_scatter):\n        for ax, toy in zip(axr, toys):\n            pre_fit = time.perf_counter()\n            scorer.detector.fit(toy.X_train, toy.Y_train)\n            post_fit = time.perf_counter()\n\n            scorer.calibrate(toy.X_valid, toy.Y_valid)\n            post_calibrate = time.perf_counter()\n\n            conf = scorer.predict(toy.X_test)\n            post_predict = time.perf_counter()\n\n            detector_size = _getsize(scorer.detector)\n            scorer_size = _getsize(scorer)\n\n            toy.plot(conf, ax, cmap, with_scatter)\n\n            if with_scorer is not None:\n                with_scorer(\n                    scorer,\n                    toy,\n                    Evaluation(\n                        fit_time=post_fit - pre_fit,\n                        calibrate_time=post_calibrate - post_fit,\n                        predict_time=post_predict - post_calibrate,\n                        detector_size=detector_size,\n                        scorer_size=scorer_size - detector_size,\n                        expected=toy.is_in_distribution(toy.X_test),\n                        confidence=conf,\n                    ),\n                    ax,\n                )\n\n        if with_titles and len(axr) &gt; int(with_cbar is not None):\n            axr[0].text(\n                0.5,\n                0.95,\n                title,\n                ha=\"center\",\n                va=\"top\",\n                size=20,\n                c=\"white\",\n                bbox=dict(facecolor=\"black\", alpha=0.25, edgecolor=\"white\"),\n                transform=axr[0].transAxes,\n            )\n\n        if with_cbar is not None and len(axr) &gt; 1:\n            axr[-1].spines[\"top\"].set_visible(False)\n            axr[-1].spines[\"right\"].set_visible(False)\n            axr[-1].spines[\"bottom\"].set_visible(False)\n            axr[-1].spines[\"left\"].set_visible(False)\n\n            axr[-1].xaxis.set_visible(False)\n            axr[-1].set_yticks([0.1, 0.9])\n            axr[-1].set_yticklabels([with_cbar.low, with_cbar.high])\n            axr[-1].set_ylabel(with_cbar.title, labelpad=-13)\n            axr[-1].yaxis.set_label_position(\"right\")\n            axr[-1].yaxis.tick_right()\n\n            axr[-1].imshow(\n                [[x / 100, x / 100] for x in range(100, -1, -1)],\n                cmap=cmap,\n                interpolation=\"bicubic\",\n                vmin=0.0,\n                vmax=1.0,\n                extent=[-0.05, 0.05, 0.0, 1.0],\n                zorder=-2,\n            )\n\n    fig.tight_layout()\n    fig.subplots_adjust(wspace=0.1, hspace=0.1)\n\n    return fig\n</code></pre>"},{"location":"api/toys/","title":"phepy.toys","text":""},{"location":"api/toys/#phepy.toys.ToyExample","title":"ToyExample","text":"<p>             Bases: <code>abc.ABC</code></p>"},{"location":"api/toys/#phepy.toys.ToyExample.X_test","title":"X_test  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>X_test: np.ndarray\n</code></pre>"},{"location":"api/toys/#phepy.toys.ToyExample.X_train","title":"X_train  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>X_train: np.ndarray\n</code></pre>"},{"location":"api/toys/#phepy.toys.ToyExample.X_valid","title":"X_valid  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>X_valid: np.ndarray\n</code></pre>"},{"location":"api/toys/#phepy.toys.ToyExample.Y_train","title":"Y_train  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>Y_train: np.ndarray\n</code></pre>"},{"location":"api/toys/#phepy.toys.ToyExample.Y_valid","title":"Y_valid  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>Y_valid: np.ndarray\n</code></pre>"},{"location":"api/toys/#phepy.toys.ToyExample.aspect_ratio","title":"aspect_ratio  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>aspect_ratio: float\n</code></pre>"},{"location":"api/toys/#phepy.toys.ToyExample.is_in_distribution","title":"is_in_distribution  <code>abstractmethod</code>","text":"<pre><code>is_in_distribution(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/__init__.py</code> <pre><code>@abc.abstractmethod\ndef is_in_distribution(X: np.ndarray) -&gt; np.ndarray:\n    pass\n</code></pre>"},{"location":"api/toys/#phepy.toys.ToyExample.plot","title":"plot  <code>abstractmethod</code>","text":"<pre><code>plot(\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n)\n</code></pre> Source code in <code>phepy/toys/__init__.py</code> <pre><code>@abc.abstractmethod\ndef plot(\n    self,\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n):\n    pass\n</code></pre>"},{"location":"api/toys/#phepy.toys.ToyExample.reconstruct","title":"reconstruct  <code>abstractmethod</code>","text":"<pre><code>reconstruct(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/__init__.py</code> <pre><code>@abc.abstractmethod\ndef reconstruct(X: np.ndarray) -&gt; np.ndarray:\n    pass\n</code></pre>"},{"location":"api/toys/circle/","title":"phepy.toys.circle","text":""},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample","title":"CircleToyExample","text":"<pre><code>CircleToyExample(rng: np.random.Generator, N: int = 10000)\n</code></pre> <p>             Bases: <code>ToyExample</code></p> Source code in <code>phepy/toys/circle.py</code> <pre><code>def __init__(\n    self, rng: np.random.Generator, N: int = 10_000\n) -&gt; CircleToyExample:\n    Y = np.sin(np.linspace(0, np.pi * 8.0, N))\n\n    X1 = np.sin(np.linspace(0, np.pi * 2.0, N)) * (5 + Y)\n    X2 = np.cos(np.linspace(0, np.pi * 2.0, N)) * (5 + Y)\n\n    X1 += rng.normal(loc=0.0, scale=0.1, size=N)\n    X2 += rng.normal(loc=0.0, scale=0.1, size=N)\n\n    self.__X_train = np.stack([X1, X2], axis=1)\n    self.__Y_train = Y\n\n    X1 = np.sin(np.linspace(0, np.pi * 2.0, N)) * (5 + Y)\n    X2 = np.cos(np.linspace(0, np.pi * 2.0, N)) * (5 + Y)\n\n    X1 += rng.normal(loc=0.0, scale=0.1, size=N)\n    X2 += rng.normal(loc=0.0, scale=0.1, size=N)\n\n    self.__X_valid = np.stack([X1, X2], axis=1)\n    self.__Y_valid = Y\n\n    X1T, X2T = np.mgrid[-7.5:7.5:0.01, -7.5:7.5:0.01]\n    X1T = X1T.flatten()\n    X2T = X2T.flatten()\n\n    self.__X_test = np.stack([X1T, X2T], axis=1)\n</code></pre>"},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample.X_test","title":"X_test  <code>property</code>","text":"<pre><code>X_test: np.ndarray\n</code></pre>"},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample.X_train","title":"X_train  <code>property</code>","text":"<pre><code>X_train: np.ndarray\n</code></pre>"},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample.X_valid","title":"X_valid  <code>property</code>","text":"<pre><code>X_valid: np.ndarray\n</code></pre>"},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample.Y_train","title":"Y_train  <code>property</code>","text":"<pre><code>Y_train: np.ndarray\n</code></pre>"},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample.Y_valid","title":"Y_valid  <code>property</code>","text":"<pre><code>Y_valid: np.ndarray\n</code></pre>"},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample.aspect_ratio","title":"aspect_ratio  <code>property</code>","text":"<pre><code>aspect_ratio: float\n</code></pre>"},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample.is_in_distribution","title":"is_in_distribution","text":"<pre><code>is_in_distribution(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/circle.py</code> <pre><code>def is_in_distribution(self, X: np.ndarray) -&gt; np.ndarray:\n    # Two standard deviations off the mean -&gt; 95.45% interval\n    return np.linalg.norm(X - self.reconstruct(X), axis=1) &lt;= 0.2\n</code></pre>"},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample.plot","title":"plot","text":"<pre><code>plot(\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n)\n</code></pre> Source code in <code>phepy/toys/circle.py</code> <pre><code>def plot(\n    self,\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n):\n    N_skip = len(self.X_train) // 40\n\n    ax.imshow(\n        conf.reshape(np.mgrid[-7.5:7.5:0.01, -7.5:7.5:0.01][0].shape).T,\n        cmap=cmap,\n        vmin=0.0,\n        vmax=1.0,\n        extent=[-7.5, 7.5, -7.5, 7.5],\n        origin=\"lower\",\n        interpolation=\"bicubic\",\n        rasterized=True,\n    )\n\n    ax.set_xlim(-7.5, 7.5)\n    ax.set_ylim(-7.5, 7.5)\n\n    if with_scatter:\n        ax.scatter(\n            self.X_train[::N_skip, 0],\n            self.X_train[::N_skip, 1],\n            c=\"white\",\n            marker=\"x\",\n            lw=3,\n            s=48,\n        )\n        ax.scatter(\n            self.X_train[::N_skip, 0],\n            self.X_train[::N_skip, 1],\n            c=\"black\",\n            marker=\"x\",\n        )\n\n    ax.axis(\"off\")\n</code></pre>"},{"location":"api/toys/circle/#phepy.toys.circle.CircleToyExample.reconstruct","title":"reconstruct","text":"<pre><code>reconstruct(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/circle.py</code> <pre><code>def reconstruct(self, X: np.ndarray) -&gt; np.ndarray:\n    # Project X onto the sin-perturbed circle\n    angle = _my_arctan2(X[:, 0], X[:, 1])\n\n    Y = np.sin(angle * 4.0)\n\n    X1 = np.sin(angle) * (5.0 + Y)\n    X2 = np.cos(angle) * (5.0 + Y)\n\n    # return np.stack([X1, X2], axis=1)\n    return X1.reshape((len(X), 1)) * np.array([[1, 0]]) + X2.reshape(\n        (len(X), 1)\n    ) * np.array([[0, 1]])\n</code></pre>"},{"location":"api/toys/haystack/","title":"phepy.toys.haystack","text":""},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample","title":"HaystackToyExample","text":"<pre><code>HaystackToyExample(\n    rng: np.random.Generator, N: int = 10000\n)\n</code></pre> <p>             Bases: <code>ToyExample</code></p> Source code in <code>phepy/toys/haystack.py</code> <pre><code>def __init__(\n    self, rng: np.random.Generator, N: int = 10_000\n) -&gt; HaystackToyExample:\n    N *= 2\n\n    n = 10\n    a = 2\n\n    # https://stats.stackexchange.com/a/124554\n    A = np.matrix(\n        [rng.normal(size=n) + rng.normal(size=1) * a for i in range(n)]\n    )\n    A = A * np.transpose(A)\n    D_half = np.diag(np.diag(A) ** (-0.5))\n    covs = D_half * A * D_half\n\n    X = rng.multivariate_normal(np.zeros(shape=n), covs, size=N)\n    X[:, 3] = -0.42\n\n    # Since X[:,3] is const, it does not matter what its multiplier is\n    C = rng.choice([-2, -1, 0, 0, 1, 2], size=n)\n\n    Y = np.dot(X, C)\n\n    I_train = rng.choice(N, size=N // 2, replace=False)\n    I_valid = np.ones(N)\n    I_valid[I_train] = 0\n    (I_valid,) = np.nonzero(I_valid)\n\n    self.__X_train = X[I_train]\n    self.__Y_train = Y[I_train]\n    self.__X_valid = X[I_valid]\n    self.__Y_valid = Y[I_valid]\n\n    XT = rng.multivariate_normal(np.zeros(shape=n), covs, size=N // 2)\n    XT[:, 3] = (rng.random(size=N // 2) - 0.5) - 0.42\n    # Provide some definitely ID points\n    XT[np.random.choice(N // 2, size=N // 200), 3] = -0.42\n\n    self.__X_test = XT\n</code></pre>"},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample.X_test","title":"X_test  <code>property</code>","text":"<pre><code>X_test: np.ndarray\n</code></pre>"},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample.X_train","title":"X_train  <code>property</code>","text":"<pre><code>X_train: np.ndarray\n</code></pre>"},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample.X_valid","title":"X_valid  <code>property</code>","text":"<pre><code>X_valid: np.ndarray\n</code></pre>"},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample.Y_train","title":"Y_train  <code>property</code>","text":"<pre><code>Y_train: np.ndarray\n</code></pre>"},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample.Y_valid","title":"Y_valid  <code>property</code>","text":"<pre><code>Y_valid: np.ndarray\n</code></pre>"},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample.aspect_ratio","title":"aspect_ratio  <code>property</code>","text":"<pre><code>aspect_ratio: float\n</code></pre>"},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample.is_in_distribution","title":"is_in_distribution","text":"<pre><code>is_in_distribution(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/haystack.py</code> <pre><code>def is_in_distribution(self, X: np.ndarray) -&gt; np.ndarray:\n    # Can only be ID if the constant feature value matches\n    return X[:, 3] == -0.42\n</code></pre>"},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample.plot","title":"plot","text":"<pre><code>plot(\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n)\n</code></pre> Source code in <code>phepy/toys/haystack.py</code> <pre><code>def plot(\n    self,\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n):\n    ax.spines[\"top\"].set_visible(False)\n    ax.spines[\"right\"].set_visible(False)\n    ax.spines[\"bottom\"].set_visible(False)\n    ax.spines[\"left\"].set_visible(False)\n\n    ax.set_xticks([-0.42 - 0.4, -0.42, -0.42 + 0.4])\n    ax.set_xticklabels([r\"$-0.4 \\sigma$\", \"const\", r\"$+0.4 \\sigma$\"])\n    ax.get_yaxis().set_visible(False)\n\n    ax.axvline(-0.42, c=\"white\", lw=7, zorder=-1)\n\n    # with_scatter is ignored\n    ax.scatter(self.X_test[:, 3], conf, c=\"white\", s=6, rasterized=True)\n    ax.scatter(self.X_test[:, 3], conf, c=\"black\", s=1, rasterized=True)\n\n    ax.imshow(\n        [[x / 100, x / 100] for x in range(100, -1, -1)],\n        cmap=cmap,\n        interpolation=\"bicubic\",\n        vmin=0.0,\n        vmax=1.0,\n        extent=[-0.93, 0.09, -0.01, 1.01],\n        zorder=-2,\n    )\n</code></pre>"},{"location":"api/toys/haystack/#phepy.toys.haystack.HaystackToyExample.reconstruct","title":"reconstruct","text":"<pre><code>reconstruct(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/haystack.py</code> <pre><code>def reconstruct(self, X: np.ndarray) -&gt; np.ndarray:\n    # Project X onto the line\n    return X * np.array(\n        [[1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]]\n    ) - np.array([[0.0, 0.0, 0.0, 0.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]])\n</code></pre>"},{"location":"api/toys/line/","title":"phepy.toys.line","text":""},{"location":"api/toys/line/#phepy.toys.line.LineToyExample","title":"LineToyExample","text":"<pre><code>LineToyExample(rng: np.random.Generator, N: int = 10000)\n</code></pre> <p>             Bases: <code>ToyExample</code></p> Source code in <code>phepy/toys/line.py</code> <pre><code>def __init__(\n    self, rng: np.random.Generator, N: int = 10_000\n) -&gt; LineToyExample:\n    X1 = np.concatenate(\n        [np.linspace(0, 4, N // 2), np.linspace(6, 10, N // 2)]\n    )\n    X2 = 1 + X1 * 0.5 + rng.normal(loc=0.0, scale=0.1, size=N)\n    X1 += rng.normal(loc=0.0, scale=0.1, size=N)\n\n    self.__X_train = np.stack([X1, X2], axis=1)\n    self.__Y_train = X1 * np.sqrt(1.25)\n\n    X1 = np.concatenate(\n        [np.linspace(0, 4, N // 2), np.linspace(6, 10, N // 2)]\n    )\n    X2 = 1 + X1 * 0.5 + rng.normal(loc=0.0, scale=0.1, size=N)\n    X1 += rng.normal(loc=0.0, scale=0.1, size=N)\n\n    self.__X_valid = np.stack([X1, X2], axis=1)\n    self.__Y_valid = X1 * np.sqrt(1.25)\n\n    X1T, X2T = np.mgrid[-2:12:0.01, -1:8:0.01]\n    X1T = X1T.flatten()\n    X2T = X2T.flatten()\n\n    self.__X_test = np.stack([X1T, X2T], axis=1)\n</code></pre>"},{"location":"api/toys/line/#phepy.toys.line.LineToyExample.X_test","title":"X_test  <code>property</code>","text":"<pre><code>X_test: np.ndarray\n</code></pre>"},{"location":"api/toys/line/#phepy.toys.line.LineToyExample.X_train","title":"X_train  <code>property</code>","text":"<pre><code>X_train: np.ndarray\n</code></pre>"},{"location":"api/toys/line/#phepy.toys.line.LineToyExample.X_valid","title":"X_valid  <code>property</code>","text":"<pre><code>X_valid: np.ndarray\n</code></pre>"},{"location":"api/toys/line/#phepy.toys.line.LineToyExample.Y_train","title":"Y_train  <code>property</code>","text":"<pre><code>Y_train: np.ndarray\n</code></pre>"},{"location":"api/toys/line/#phepy.toys.line.LineToyExample.Y_valid","title":"Y_valid  <code>property</code>","text":"<pre><code>Y_valid: np.ndarray\n</code></pre>"},{"location":"api/toys/line/#phepy.toys.line.LineToyExample.aspect_ratio","title":"aspect_ratio  <code>property</code>","text":"<pre><code>aspect_ratio: float\n</code></pre>"},{"location":"api/toys/line/#phepy.toys.line.LineToyExample.is_in_distribution","title":"is_in_distribution","text":"<pre><code>is_in_distribution(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/line.py</code> <pre><code>def is_in_distribution(self, X: np.ndarray) -&gt; np.ndarray:\n    # Two standard deviations off the mean -&gt; 95.45% interval\n    return np.linalg.norm(X - self.reconstruct(X), axis=1) &lt;= 0.2\n</code></pre>"},{"location":"api/toys/line/#phepy.toys.line.LineToyExample.plot","title":"plot","text":"<pre><code>plot(\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n)\n</code></pre> Source code in <code>phepy/toys/line.py</code> <pre><code>def plot(\n    self,\n    conf: np.ndarray,\n    ax: mpl.axes.Axes,\n    cmap: Union[str, mpl.colors.Colormap],\n    with_scatter: bool = True,\n):\n    N_skip = len(self.X_train) // 40\n\n    ax.imshow(\n        conf.reshape(np.mgrid[-2:12:0.01, -1:8:0.01][0].shape).T,\n        cmap=cmap,\n        vmin=0.0,\n        vmax=1.0,\n        extent=[-2, 12, -1, 8],\n        origin=\"lower\",\n        interpolation=\"bicubic\",\n        rasterized=True,\n    )\n\n    ax.set_xlim(-2, 12)\n    ax.set_ylim(-1, 8)\n\n    if with_scatter:\n        ax.scatter(\n            self.X_train[::N_skip, 0],\n            self.X_train[::N_skip, 1],\n            c=\"white\",\n            marker=\"x\",\n            lw=3,\n            s=48,\n        )\n        ax.scatter(\n            self.X_train[::N_skip, 0],\n            self.X_train[::N_skip, 1],\n            c=\"black\",\n            marker=\"x\",\n        )\n\n    ax.axis(\"off\")\n</code></pre>"},{"location":"api/toys/line/#phepy.toys.line.LineToyExample.reconstruct","title":"reconstruct","text":"<pre><code>reconstruct(X: np.ndarray) -&gt; np.ndarray\n</code></pre> Source code in <code>phepy/toys/line.py</code> <pre><code>def reconstruct(self, X: np.ndarray) -&gt; np.ndarray:\n    # Project X onto the line\n    return np.array([[0.0, 1.0]]) + np.array([[1.0, 0.5]]) * (\n        np.matmul((X - np.array([0.0, 1.0])), np.array([[1.0], [0.5]]))\n        / np.matmul(np.array([[1.0, 0.5]]), np.array([[1.0], [0.5]]))\n    )\n</code></pre>"}]}